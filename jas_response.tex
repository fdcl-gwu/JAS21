\documentclass[11pt]{article}
\usepackage[letterpaper,text={6.5in,8.6in},centering]{geometry}
\usepackage{amssymb,amsmath,amsthm,times,url}
\usepackage{xr,xcite,color}
\usepackage{threeparttable,booktabs}
\usepackage{pdfpages}
\usepackage{algpseudocode,cases}
\usepackage{siunitx}
\usepackage{cleveref}

\newcommand{\norm}[1]{\ensuremath{\left\| #1 \right\|}}
\newcommand{\bracket}[1]{\ensuremath{\left[ #1 \right]}}
\newcommand{\braces}[1]{\ensuremath{\left\{ #1 \right\}}}
\newcommand{\parenth}[1]{\ensuremath{\left( #1 \right)}}
\newcommand{\pair}[1]{\ensuremath{\langle #1 \rangle}}
\newcommand{\met}[1]{\ensuremath{\langle\langle #1 \rangle\rangle}}
\newcommand{\refeqn}[1]{(\ref{eqn:#1})}
\newcommand{\reffig}[1]{Fig. \ref{fig:#1}}
\newcommand{\tr}[1]{\mathrm{tr}\ensuremath{\negthickspace\bracket{#1}}}
\newcommand{\trs}[1]{\mathrm{tr}\ensuremath{[#1]}}
\newcommand{\deriv}[2]{\ensuremath{\frac{\partial #1}{\partial #2}}}
\newcommand{\SO}{\ensuremath{\mathsf{SO(3)}}}
\newcommand{\T}{\ensuremath{\mathsf{T}}}
\renewcommand{\L}{\ensuremath{\mathsf{L}}}
\newcommand{\so}{\ensuremath{\mathfrak{so}(3)}}
\newcommand{\SE}{\ensuremath{\mathsf{SE(3)}}}
\newcommand{\se}{\ensuremath{\mathfrak{se}(3)}}
\renewcommand{\Re}{\ensuremath{\mathbb{R}}}
\newcommand{\aSE}[2]{\ensuremath{\begin{bmatrix}#1&#2\\0&1\end{bmatrix}}}
\newcommand{\ase}[2]{\ensuremath{\begin{bmatrix}#1&#2\\0&0\end{bmatrix}}}
\newcommand{\D}{\ensuremath{\mathbf{D}}}
\newcommand{\Sph}{\ensuremath{\mathsf{S}}}
\renewcommand{\S}{\Sph}
\newcommand{\J}{\ensuremath{\mathbf{J}}}
\newcommand{\Ad}{\ensuremath{\mathrm{Ad}}}
\newcommand{\intp}{\ensuremath{\mathbf{i}}}
\newcommand{\extd}{\ensuremath{\mathbf{d}}}
\newcommand{\hor}{\ensuremath{\mathrm{hor}}}
\newcommand{\ver}{\ensuremath{\mathrm{ver}}}
\newcommand{\dyn}{\ensuremath{\mathrm{dyn}}}
\newcommand{\geo}{\ensuremath{\mathrm{geo}}}
\newcommand{\Q}{\ensuremath{\mathsf{Q}}}
\newcommand{\G}{\ensuremath{\mathsf{G}}}
\newcommand{\g}{\ensuremath{\mathfrak{g}}}
\newcommand{\Hess}{\ensuremath{\mathrm{Hess}}}
\newcommand{\refprop}[1]{Proposition \ref{prop:#1}}
\newcommand{\todo}{{\large \textcolor{red}{TODO: }}}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\newtheorem{definition}{Definition}%[section]
\newtheorem{lem}{Lemma}%[section]
\newtheorem{prop}{Proposition}%[section]
\newtheorem{remark}{Remark}%[section]
\newtheorem{theorem}{Theorem}%[section]

\newenvironment{correction}{\begin{list}{}{\setlength{\leftmargin}{1cm}\setlength{\rightmargin}{1cm}}\vspace{\parsep}\item[]``}{''\end{list}}
\newcommand{\comment}[1]{\item \itshape #1 \normalfont}

\externaldocument{manuscript}
\externalcitedocument{manuscript}

\begin{document}

%\pagestyle{empty}

\section*{Response to the Reviewers' Comments for JASS-D-20-00049}

The author would like to thank the reviewers for their thoughtful comments, which are aimed towards improving the quality of the paper and the clarity of the results.
In accordance with the comments and suggestions, the manuscript has been revised, and the answers to all comments are addressed as follows.

(In the revised manuscript, the citation numbers for equations, assumptions, propositions, and references are changed. This answer is written according to the new item numbers.)

\subsection*{Associate Editor}

\setlength{\leftmargini}{0pt}
\begin{itemize}\setlength{\itemsep}{2\parsep}

\comment{
    Based on the advice received, I have decided that your manuscript could be reconsidered for publication should you be prepared to incorporate major revisions. 
    When preparing your revised manuscript, you are asked to carefully consider the reviewer comments which can be found below, and submit a list of responses to the comments. 
    You are kindly requested to also check the website for possible reviewer attachment(s).
}

Thanks for the comments. All of the comments have been addressed in the following response letter, and the manuscript has been revised accordingly. 
The detailed responses to each comment are given in the subsequent pages.  
As a note, reference numbers to citations or equations may not match the manuscript in this response.

\end{itemize}

\clearpage\newpage
\subsection*{Reviewer 2}
\begin{itemize}\setlength{\itemsep}{2\parsep}

    
    \comment{The article proposes a scheme to construct the shape of an asteroid from range measurements using a LIDAR or a similar instrument. 
        It also presents a method to further refine the shape construction by using an optimal guidance scheme to maneuver the spacecraft. 
        It seems to me that the proposed schemes work well; the construction of shapes in the examples considered is accurate with low computational cost. 
        The article is innovative and will be of interest to researchers working on asteroid missions.   

        I have a couple of questions:
    }


\comment{(1) The spacecraft dynamics model considered in the article is that of a dumbbell. 
Why was such a model chosen instead of an arbitrary rigid spacecraft?
Is it because the RHS of equations (4) and (6) will be more complicated for a rigid spacecraft ?
Also, equation (12) will be an integral and the shape construction scheme will be more computationally intensive.
Some comments addressing this point in the article may be useful.}

The motivation is to capture the effects of the relative attitude between spacecraft and asteroid on the corresponding gravitational force and moment. 
The primary benefit of the dumbbell approximation is that the additional integral over the entire body is avoided. 
While conceptually and analytically simple the dumbbell model still captures the important rigid body effects on the system, namely the coupling of attitude and translational states through the external forces and moments.
In addition, this type of spacecraft model is prevelant in the field~\cite{kulumani2017b,lee2006a,lee2007a,elmasri2005}.
To clarify these, additional comments have been added to the manuscript explaining this decision and copied here.


\begin{correction}
The dumbbell model is in some sense the simplest approximation of an extended rigid body.
This model captures the important dynamics of an extended rigid body with a minmum of additional complexity and is prevelant the literature~\cite{kulumani2017b,lee2006a,lee2007a,elmasri2005}.
In addition, the developments of the dumbbell model can be trivially extended to include a larger number of discrete masses to better approximate a more complicated spacecraft model.
\end{correction}

\comment{(2) In addition to range measurements for the asteroid surface, I think that inertial positions of the centers of mass of the asteroid and the spacecraft will be necessary.
How are these obtained?}

In our analyis, we have assumed that the inertial position of both the asteroid and vehicle are available prior to the mapping operations.
This data is typically available as ground based measurements are required to rendezvous with the asteroid prior to mapping.
Additional comments have been added to the manuscript and are repeated here.

\todo Add to second paragraph of Section 4.3 Numerical example immediately after the sentence: ''In other words the initial orientation is given by \( R_0 = \exp(\frac{\pi}{2} \hat e_3)\).``

\begin{correction}
    We assume that the initial intertial state of the vehicle is available. 
    This data is typically available from a ground based orbit determination scheme which enabled the original orbital rendezvous. 
\end{correction}

\end{itemize}


\clearpage\newpage
\subsection*{Reviewer 4}

\begin{itemize}\setlength{\itemsep}{2\parsep}

\comment{    Dear authors,
This paper is very well written and discusses an important topic in the spacecraft exploration of small bodies - how can we simplify current approaches and proximity operations, and also not rely as much on ground in the loop support? The techniques are well described and the presentation is easy to follow.
My first concern is the lack of references to recent missions such as Rosetta, Hayabusa2, and Osiris-Rex, and the discussion or comparison to approaches taken in these missions for going from approach to landing. 
Although the techniques presented in this paper are very interesting and seem to simplify proximity operations at small bodies, it is difficult to clearly see the benefits since there is no comparisons to the recent techniques implemented in the more recent missions than those referenced.
My second concern is the impact of spacecraft state uncertainties and non-gravitational accelerations on the results presented.
Although the authors seem to include this as future work, it would be best to include this discussion in this paper to some extend, as these inputs usually drive uncertainties in determining shape modeling and defining landing areas.  
Finally, the authors should augment the paper discussing onboard requirements to allow implementation of the techniques presented, since portability can also be a challenge.

%Specific comments:
}

Thank you for the comments aimed at improving the quality of the manuscript. 
Additional references and discussion related to more recent missions have been included.

In addition, additional detail concerning spacecraft/state uncertainties and perturbing forces has been added to the manuscript.
The discussion discusses the current limitations of the presented approach and discuses this as an area of future work.
Specific comments related to these comments have been included below.

\comment{A few possible typos:
- I would write "dynamical" instead of dynamic at a number of places, but this might be a writing style: Intro line 25 \& 30, page 19 line 31.
}

Thank you for this comment. 
We have replaced ``dynamic'' with ``dynamical'' in several locations throughout the manuscript.
We do not repeat the corrections here for simplicity.

\todo Use dynamical throughout manuscript

\comment{
Page 3, line 33-34, the citations of Hayabusa1 and NEAR seem mis-used. Hayabusa stayed 3 months at Itokawa and the mission operations team did not report requiring a polyhedron potential model for landing (if so, a reference would be needed). 
NEAR did orbit about 1 year from orbit insertion to landing.
There could be references to more recent missions highlighting the specifics of the proximity operation implementations and their lacks.
}

Depending on the specific mission objectives the mapping phase may serve multiple purposes, such as landing site selection or shape modelling.
In this work, we seek to utilize the mapping phase to create a shape model.
The shape model is then used for multiple purposes including the polyhedron potential model and landing site selection.
We have added additional discussion related to more recent missions and copied below.

\todo Add to introduction section - replacing the sentence: ''After arrival, a spacecraft will generally spend months or years in a mapping mission phase.``
\begin{correction}
After arrival, space will generally spend upwards of several months in a mapping mission phase~\cite{williams2018,kubota2003,cole1998}.
For example, the recent OSIRIS-REx mission used global imagery to create digital terrain maps over the span of approximately seven months~\cite{williams2018}.

\end{correction}


\comment{
Page 3 line 41-42 with reference 13, The asteroid redirect mission has been canceled, and so this reference seems somewhat irrelevant when trying to highlight long delays in implementing operations that would require mapping and a better defined potential.
A reference to OREx would be more appropriate.
The specifics of how the techniques proposed in the paper could have changed the proximity operations of OREx need to be included and described better.
}

\todo Remove citation ''gates2015`` in the introduction. 

\todo add following citations~\cite{williams2018} instead.

The citation to the asteroid redirect mission has been removed and additional discussion related to the OSIRIS-REx mission has been incorporated.
The additional discussion has been copied below.

\todo Add following after sentence: ''Depending on the mission type, this long period of mapping is curicial to the mission, such as sample collection.``
\begin{correction}
For example, the OSIRIS-REx mission spent approximately seven months in mapping phase where digitial terrain maps and a shape model were constructed in support of main sample collection mission.
\end{correction}

\comment{
Page 3, line 48-49, saying "The dependency on expensive ground-based shape reconstruction technique limits the ability of spacecraft to autonomously operate at asteroids." seems misleading.
What does "expensive" mean or refer to? The ability of spacecraft to autonomously operate at asteroids is limited by the lack of portable solutions and/or opportunities to test those portable solutions, rather than being able to use ground-based techniques.
}

Thank you for the comment.
This sentence has been removed and replaced with the following:

\todo Remove sentence and replace

\begin{correction}
Onboard shape reconstruction techniques enable autonomous operations which allow for a greater range of spacecraft operations.
\end{correction}


\comment{
Page 4 line 7, "onboard" as opposed to "onborad".
}

This typo has been corrected.

\todo Correct typo.

\comment{
Page 4, line 37, "During this simulation, this update shape model is then used in a nonlinear controller...". The second "this" should not have a capital "T", and should be "used in" as opposed to "used to in" .
}

\todo Correct typo
This typo has been corrected and the corrected sentence is shown below.

\begin{correction}
During this simulation, this updated shape model is then used in a nonlinear controller to track a desired state trajectory for the dynamics of a rigid body spacecraft.
\end{correction}

\comment{
Page 8, line 1-2, the authors should augment the statement made citing reference 7 with one or two sentences for the unfamiliar reader.  
}

Additional detail describing the polyhedron potential model is added and copied below.

\begin{correction}
    The sum \( \sum \omega_f \) vanishes when outside the body and equals \( -4 \pi \) inside.
\end{correction}

\comment{
In 3.1, the authors should discuss range measurements done with recent missions, what was successful and what was not, to distinguish their approach more efficiently. 
References 17 and 18 seem outdated. 
References to more recent work or missions are needed.
}

More recent references from the OSIRIS-REx mission have been included and additional discussion is added as copied below.

\begin{correction}
We assume the spacecraft contains a range sensor, such as LIDAR, that allows for the accurate measurement of the relative distance between the spacecraft and asteroid~\cite{zuber1997,zuber2000}.
Recent missions such as OSIRIS-REx have featured a scanning LIDAR system which allows for much higher measurement rates compared to previous missions~\cite{lauretta2017,daly2017}.
In these mission, ranging measurements are combined with imagery to derive a shape model using a ground based method~\cite{gaskell2008}.
In constrast to previous missions, the scanning LIDAR system on OSIRIS-REx enables for high surface sample rates in spite of the low ground-track velocities~\cite{daly2017}.
\end{correction}

\comment{
Page 8, line 31, the equation for "d" should be "(Delta TOF * c)/2" not "(Delta TOF)/(2c)". I would assume the equation is correct in the code but the authors should check.
}

The equation has been corrected and is copied below.
The code has been rechecked. 

\todo Correct the equation

\begin{correction}
    \(d = \frac{\Delta TOF c}{2} \) 
\end{correction}

\comment{
In 3.2, it is unclear how the boundaries of areas being updated are being treated, whereas it seems discontinuity could easily be seen in results but would need to be addressed to some extend? 
It may be good to add a few sentences about boundary conditions and how these are treated.
}

Each measurement is used to only update vertices which lie within some user defined angular constraint, \( \Delta \sigma_{max} \).
In this approach only the radial distance of each vertex is changed as a function of the measurements. 
As a result the topology of the polyhedron shape does not vary and the model remains watertight and closed.
In addition, the correlation based sensor model used in this approach ensures that vertices further from the measurement have a higher variance and therefore reduced displacement for a given measurement. 
The scaling factor \( c \) and the angular constraint \( \Delta \sigma_{max} \) can also be used to adjust the region of impact of a given measurement. 
Adjusting these scalars, in addition to the a priori probability of the initial shape model can be utilized to ensure that steep gradients on the surface are not artificially introduced during the mapping process.
Additional detail has been added to the manuscript and is shown below.

\todo Copy into paper after equation 19.

\begin{correction}
    The parameters \( c \) and \( \Delta \sigma_{max} \) are used to define the region of impact of each measurement. 
    The angular constraint \( \Delta \sigma_{max} \) sets a hard constraint on the vertices which need to be updated for a given measurement.
    The scalar \( c \) may then be used to adjust the variance \( w_{j,i} \) as a function of the distance between measurement \( j \) and vertex \( i \).
    These two parameters may be used to minimize steep gradients that may occur during the shape reconstruction process.
\end{correction}

\comment{
In 3.3, the authors should discuss the impact of spacecraft state errors and non-gravitational accelerations on the results of this technique. 
Is this assumed to be a task left for ground operations?
I also noticed this seems to be part of future work. It may be good to mention in the text also.
}

Additional detail regarding the impact of spacecraft state uncertainty and non-gravitational accelerations have been included in the manuscript and are shown below.

\todo Copy into section 4.3. Either the first paragraph or a new second paragraph

\begin{correction}
    In this numerical example we have assumed the perfect knowledge of the spacecraft state. 
    This is a strong assumption that would not exist in any realistic situation. 
    However, the measurement model defined in the previous section may be extended to consider the uncertainty in both the state \( x \) and the range measurement \( d \) rather than combining them into a single random variable \( p \).
    In addition, the dynamics defined by~\crefrange{eq:x_dot}{eq:omega_dot} do not consider any non-gravitational accelerations such as solar radiation pressure on the vehicle.
    In general, these types of external forces will primarily serve to increase state uncertainty and cause large errors in the closed loop control system.
    Adaptive control techniques have been demonstrated in the past to address both fixed and time varying disturbances of this kind~\cite{kulumani2017a}.
    However, these topics are beyond the scope of this paper focusing on optimal guidance for Bayesian shape reconstruction, and relegated to future works. 
\end{correction}

\comment{
In 4.3, references should be added for the shape models used for this work.}

A reference for the radar shape models has been added.

\todo Add to paper

\begin{correction}
We utilize radar shape models of asteroid \num{4769} Castalia and (\num{52760}) \num{1998} \(\text{ML}_{14}\)~\cite{neese2004}.
\end{correction}

\comment{
In 4.3, line 45 - 47, "asteroids" should have no "s". 
}

The ''s`` has been removed and the corrected sentence is shown in the previous response.


\comment{
Also, mentioning "initially unknown asteroid" is contradicting earlier statements and the following paragraph since a simple shape model is required for this technique.
}

The sentence has been reworded to more accurately reflect the level of knowledge required.
It is copied here as:

\todo Correct in paper

\begin{correction}
These demonstrate the ability of a spacecraft to autonomously explore and maneuver around an initially poorly modeled asteroid while incrementally updating the shape model.
\end{correction}

\comment{
In 4.3, page 20, statement starting on line 17, do the asteroid size and rotation period have no impact on the reconstruction time required? 
What amount of data does this mean? 
it is difficult to gauge what is needed for this onboard processing to be possible, or if this would be readily feasible.
}

The shape refinement process defined in~\cref{sec:radius_update} is by definition a local refinement process.
Rather than operating on the entire shape model only the region defined by the angular constraint \( \Delta \sigma_{max}\) is considered in each measurement update. 
The user can adjust this parameter to ensure a constant number of vertices are considered for each measurement update and therefore maintain a constant number of computations based on processor capabilities. 
In addition, the refinement process introduced in~\cref{sec:landing_refinement} can be utilized to allow for higher fidelity in a small region.
An appropriate choice of \( \Delta \sigma_{max} \) is again crucial to maintain constant computational requirements.
Additional discussion has been added to the manuscript discussing this feature of our approach and is copied below.

\todo Correct in paper

\begin{correction}
    The angular constraint \( \Delta \sigma_{max} \) may be used to adjust the computational requirements of the shape refinement process.
    Larger values of \( \Delta \sigma_{max} \) result in a greater computational demand as a given measurement ray is used to update a larger number of vertices.
    \Cref{sec:landing_refinement} presents an approach to allow for a higher resolution mesh in certain regions to capture finer surface details without excessive resources. 
\end{correction}

\comment{
As for my comment for 3.3, it would be best to describe the impact of spacecraft uncertainties on these results.
The spacecraft orbit seems to resemble that of Hayabusa - this is inferred from using the "home position" nomenclature. 
Is the technique best used with this kind of approach as opposed to following some orbits like what was done with the OREx mission? A discussion might be required here.
How does this translate in terms of fuel consumption? or delta-V imparted to the spacecraft?  
}

The guidance scheme presented in~\cref{sec:explore_asteroid} will drive the vehicle towards states which will best reduce the total uncertainty of the shape model.
As a result the vehicle in general may take an arbitrary trajectory about the body and utilize much larger control effort compared to utilizing the natural dynamics of the system. 
We do not duplicate the motion of Hayabusa but did utilize the ``home position'' term to describe the numerical example.
Our shape refinement approach is not limited to our guidance scheme but rather is an example of combining closed loop control with our shape refinement method.
We will consider incorporating control effort constraints in our optimal guidance scheme in a future work.

\todo Correct in paper

\comment{
Fig 7 \& 8, what causes some areas to remain with high uncertainties? This would need to be discussed for both ML14 and Castalia.
}

These figures show the shape model uncertainty during the refinement process.
Areas that have not been measured by the vehicle will have large uncertainties compared to those areas already surveyed. 
Only after the vehicle has measured the entire surface will the shape model have a near constant uncertainty defined by 
\begin{align*}
    \sum_i w_i.
\end{align*}
An additional comment has been added to the figure captions and is shown below.

\todo Correct in paper
\begin{correction}
    Areas of high uncertainty are in yellow while areas of low uncertainty are in purple.
    The guidance scheme continually selects regions of high uncertainty until the total shape uncertainty is sufficiently small.
\end{correction}

\comment{
As part of section 5, the authors should discuss impacts of more complex criteria for landing or surface sampling, for instance, types of material on the surface, poles versus equatorial areas, etc. 
It may be good to look at sampling requirements and criteria of recent missions to see how they would affect the technique described.
}

Our landing site selection algorithm is relatively simple as it is directly evaluated by the shape model.
The approach was chosen as an example to demonstrate how a vehicle can autonomously model the shape of the asteroid, then utilize that shape model to chose a landing site. 
Additional costs such as surface material or location on the body can be added as additional criteria in~\cref{eq:surface_cost}.
We have added additional discussion concerning the landing site selection approach.

\todo Correct in paper
\begin{correction}
    The surface cost described here is relatively simple and chosen to be solely a function of the current spacecraft position and shape model.
    Additional scientific criteria such as surface material or location on the body, e.g. equatorial vs. polar regions, can be utilized instead of a random science value as presented here.
\end{correction}

\comment{
Conclusion:
Page 30, line 45, "significant" instead of "signification".
}
The typo has been corrected and is shown below.

\todo Correct in paper
\begin{correction}
This is in contrast to standard shape reconstruction algorithms which operate over the entire surface and require significant computational resources.
\end{correction}

\comment{
The future works mentioned are definitely of interest!
}

Thank you and we look forward to future work in this area.

\end{itemize}


\bibliographystyle{IEEEtran}
\bibliography{library}

\end{document}



